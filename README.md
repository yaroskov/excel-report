# Excel Report

Ru:

Это программное обеспечение для создания отчета по логам инцидента.

Установка:

1. Скачайте Git с официального сайта:
2. Скачайте и установите Python 3 с официального сайта:
3. Откройте консоль Bash, которая поставляется вместе с Git.
4. Перейдите в нужную вам директорию с помощью команды "cd".
5. Склонируйте в целевую директорию репозиторий программы "Excel Report" с помощью команды: git@github.com:yaroskov/excel-report.git

Использование:

Сборка полного отчета:

1. выполните установку согласно инструкции выше, п.1;
2. подготовьте исходный файл с логами;
   1. сохраните интересующий вас лист из Excell-файла в формат htm/html;
   2. расположите данный файл в путь paths->source, указанный в файле config.py (в корне программы) и пропишите его там:
   ```
   paths = {
       ...
       "source": "excel_report/source/source_file.htm",
       ...
   }
   ```
3. если вы хотите использовать псевдонимы для месседжей с ошибками пропишите пары "msg" - "pseudo" в файле pseudos.py:
   ```
   data = [
	{
		"msg": "docType may not be empty",
		"pseudo": "Это псевдоним из листа псевдонимов"
	},
   ]
   ```
4. откройте удобную для вас конслоь, например "cmd.exe" и выполните:
   ```
   py run_all.py
   ```
5. Готовый отчет будет собран в папку "/report"

Запуск отдельных модулей:

Список задач:

3. для начала нужно подготовить список задач из системы Jira, для этого вам потребуется;
   1. в системе Jira выполните поиск поиск задач, задав нужные вам параметры;
   2. сделайте экспорт списка задач выбрав формат "HTML (Все поля)";
   3. расположите данный файл в путь, указанный в файле config.py: tasks->source;
   4. в консоли перейдите в корень с установленной программой, выполните:
   ```
   py run_tasks.py
   ```
   5. пропишите путь к итоговому файлу: в config.py: tasks->list:
   ```
   "tasks": {
        "list": "tasks/results/tasks_27-12-2021_20.05.51.json",
   ```
4. теперь нам сужно построить файл данных для отчета и соотнести их со списком задач из предыдущего пункта:
   1. 
5. Откройте удобную для вас конслоь, например "cmd.exe":
   1. настройте необходимые параметры в "config.py":
      1. 
   2. в файле config.py

Описание конфигурации:

1. Для начала работы вам потребуется настроить программу с помощью конфигурационных файлов:
   1. config.py
   2. pseudos.py
2. config.py - основной файл конфигурации программы, необходим для работы:
   1. В Json объекте "paths" содержатся следующие поля:
      1. results_full - путь к файлу с результатами обработки данных, создается в ходе работы программы;
      2. results_light - см. предыдущий пункт, но не содержит детальную информацию об инцидентах;
      3. results - путь, который вы указываете для создания человеко-читабельного отчета;
      4. source - путь к фалу с исходными данными в формате HTML;
      5. report - путь для сохранения человеко-читабельного отчета;
      6. tasks - набор путей для файлов с задачами системы Jira в формате HTML;
         1. list - результат работы обработчика задач, задается вручную для последующего создания отчета:
         2. source - исходный файл с задачами в формате HTML;
         3. results - путь к папке с результатами обработки задач Jira.
   2. По умолчанию config.py выглядит следующим образом:
   ```
   {
    "results_full": "excel_report/results/full/",
    "results_light": "excel_report/results/light/",
    "results": {
        "ready": "excel_report/results/light/results_light_30-12-2021_03.28.43.json"
    },
    "source": "excel_report/source/source_file.htm",
    "report": "report/",
    "tasks": {
        "list": "tasks/results/tasks_27-12-2021_20.05.51.json",
        "source": "tasks/source/jira.egovdev 2021-12-27T19_57_08+0300.html",
        "results": "tasks/results/"
    }
   }
   ```
3. pseudos.py - файл конфигурации псевдонимов для ошибок:
   1. JSON-объект "data" является массивом субобъектов, содержащих следующие поля:
      1. msg - чообщение или его часть, которому нужно присвоить псевдоним;
      2. pseudo - собственно сам псевдоним, он будет осображаться в отчете вместо сообщеня ошибки.
   2. Файл имеет следующий вид:
   ```
   data = [
	{
		"msg": "docType may not be empty",
		"pseudo": "Это псевдоним из листа псевдонимов"
	},
	{
		"msg": "java.lang.NullPointerException",
		"pseudo": "Некий нуллпоинтер"
	},
	{
		"msg": "Smev3CallError{errorCode=ASYNCH_CALL_ERROR",
		"pseudo": "СМЕВ 3 Асинхронный - ошибки разные, но псевдоним одинаковый"
	}
   ]
   ```
