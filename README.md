**Ru:**

# Excel Report
## Обработка логов и создание отчета

---
### Содержание:
1. **Контакты**
2. **Описание**
3. **Установка**
4. **Подготовка к использованию**
   1. _Установка_
   2. _Исходный файл с логами_
   3. _Выгрузка задач из **Jira**_
5. **Опциональные параметры**
   1. _Словарь уникализации_
   2. _Словарь сервисов_
6. **Запуск**

---
### 1. Контакты:
По любым вопросам обращаться по адресу: **yaroskov@yandex.ru**

С уважением, 

**Ярослав Ковалев**

---
### 2. Описание:
Данное программное обеспечение используется для формирования отчета из массива логов.

---
### 3. Установка:
1. Скачайте и установите **Git** с официального сайта: **https://git-scm.com/downloads**
2. Скачайте и установите **Python 3** с официального сайта: **https://www.python.org/downloads/**
3. Откройте консоль **Bash** (в списке установленных программ), которая поставляется вместе с **Git**.
4. Перейдите в нужную вам рабочую директорию с помощью команды **"cd"**, например:
   ```
   mkdir D:\py
   cd D:\py
   ```
5. Склонируйте в целевую директорию репозиторий программы **"Excel Report"** с помощью команды: 
   ```
   git clone git@github.com:yaroskov/excel-report.git
   ```
6. Переименуйте папку **"config_default"** в **"config"**.

---
### 4. Подготовка к использованию:
1. **Установка.** Выполните установку согласно инструкции выше - **"3. Установка"**;
2. **Исходный файл с логами.** Создайте файл с логами пригодный для парсинга, для этого:
   1. Получите у **ответственного лица** исходный файл с логами в формате **Excell**.
   2. Откройте исходный **Excel файл** с логами и сохраните только 1 лист, в котором содержатся логи, в формат **htm/html**.
   3. Сохраненный вами файл (в формате **htm/html**) поместите в путь **"excel_report/source/"**.
   4. Пропишите полный путь с наименованием исходного файла в файл **config/lib/paths.py**:
   ```
   paths = {
       ...
       "source": "excel_report/source/source_file.htm",
       ...
   }
   ```
3. **Выгрузка задач из Jira**:
   1. Сделайте выгрузку задач из системы Jira в формате **html (все поля)**.
   2. Сохраненный вами файл с задачами (в формате **html**) поместите в путь **"excel_report/tasks/source/"**.
   3. Пропишите полный путь с наименованием исходного файла в файл **config/lib/paths.py**:
      ```
      paths = {
          ...
          "source": "excel_report/tasks/source/jira.egovdev 2021-12-30T18_08_05+0300.html",
          ...
      }
      ```
### 5. Опциональные параметры:
1. **_Словарь уникализации._** В ходе работы вы можете обнаружить, что многие ошибки схожи между собой. В таком случае вам может понадобиться отмечать их как одну и ту же ошибку. Для этого вам понадобится задать **правила уникальности**:
   1. Задайте правила уникальности в файле **"config/lib/dict.py"**:
      ```
      """
      В поле 'source' содержится исходное сообщение об ошибке, поле необязательно.
      
      В поле 'target' содержится сообщение об ошибке, в котором уникальная часть
      ошибки заменена на переменную '[[target]]'. Т.е. все ошибки, с данным сообщением,
      но разным 'orderId' будут помечаться как одна ошибка.
      
      В поле 'pseudo' содержится красивое описание ошибки - его сочиняет автор словаря.
      """
      messages = [
      {
          'source': 'Error while calling esia for orderId = 1711620077, statusCode = 400',
          'target': 'Error while calling esia for orderId = [[target]], statusCode = 400',
          'pseudo': 'Этот текст отображается в отчете'
      },
      ...
      ```
   2. В файле **config/config.py** в переменной **options** поставьте значение **useDict: True**:
      ```
      options = {
          "useDict": True,
          ...
      }
      ```
      
2. **_Словарь сервисов._** Если вы хотите, чтобы рядом с наименованием услуги в отчете проставлялся также и ее номер заполните словарь услуг и их номеров:
   1. Пропишите словарь номеров услуг **"config/lib/services.py"**:
      ```
      data = [
      {
          "msg": "Активация корп сим карты от ФЛ",
          "srvice": "666"
      },
      ...
      ]
      ```
   2. В файле **config/config.py** в переменной **options** поставьте значение **useUnique: True**:
      ```
      options = {
          "useServices": True,
          ...
      }
      ```
### 6. Запуск:
   1. Откройте удобную для вас консоль, например "cmd.exe" и выполните:
      ```
      py run_all.py
      ```
   2. Готовый отчет в формате **html** будет собран в папку **"report/"**:
      1. Откройте полученный файл в формате **html** в браузере.
      2. Скопируйте содержимое окна браузера и вставьте в окно офисного приложения для документов, например "Microsoft Word".
   